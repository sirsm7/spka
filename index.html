<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar AI bersama SirSM - Modul Pintar</title>
    
    <!-- Kod Favicon Ditambah Di Sini -->
    <link rel="icon" type="image/png" href="SirSM.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Markdown Parser untuk paparan cantik respons AI -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Lexend', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            900: '#1e3a8a',
                        }
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        body { scroll-behavior: smooth; }
        .gradient-text {
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .blob {
            position: absolute;
            filter: blur(60px);
            z-index: -1;
            opacity: 0.4;
            animation: move 10s infinite alternate;
        }
        @keyframes move {
            from { transform: translate(0, 0) scale(1); }
            to { transform: translate(20px, -20px) scale(1.1); }
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }
        
        /* Quiz Styles */
        .quiz-option { transition: all 0.2s ease; }
        .quiz-option:hover { transform: translateX(5px); border-color: #3b82f6; }
        .quiz-correct { background-color: #dcfce7 !important; border-color: #22c55e !important; color: #15803d !important; }
        .quiz-wrong { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #b91c1c !important; }
        
        /* Tab Styles */
        .tab-active { background-color: #2563eb; color: white; border-color: #2563eb; }
        .tab-inactive { background-color: white; color: #475569; border-color: #e2e8f0; }
        .tab-inactive:hover { background-color: #f8fafc; color: #2563eb; }

        /* AI Output Styles */
        .prose h1 { font-size: 1.5em; font-weight: bold; margin-bottom: 0.5em; color: #1e3a8a; }
        .prose h2 { font-size: 1.25em; font-weight: bold; margin-top: 1em; margin-bottom: 0.5em; color: #2563eb; }
        .prose ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
        .prose ol { list-style-type: decimal; padding-left: 1.5em; margin-bottom: 1em; }
        .prose p { margin-bottom: 1em; line-height: 1.6; }
        .prose strong { color: #1e293b; font-weight: 700; }
        .prose pre { background: #1e293b; color: #e2e8f0; padding: 1em; border-radius: 0.5em; overflow-x: auto; font-family: monospace; font-size: 0.9em; margin-bottom: 1em; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased selection:bg-brand-100 selection:text-brand-900">

    <!-- API Key Modal (Hidden by default, shown if key needed) -->
    <div id="apiKeyModal" class="hidden fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl border border-slate-700">
            <div class="text-center mb-6">
                <div class="w-12 h-12 bg-brand-100 text-brand-600 rounded-full flex items-center justify-center mx-auto mb-3 text-xl">
                    <i class="fa-solid fa-key"></i>
                </div>
                <h3 class="text-xl font-bold text-slate-900">Kunci API Diperlukan</h3>
                <p class="text-sm text-slate-500 mt-2">Untuk menggunakan ciri pintar AI (Auto-Isi & Simulasi), sila masukkan Google Gemini API Key anda. Ia percuma.</p>
            </div>
            <input type="password" id="userApiKey" placeholder="Tampal API Key di sini (AIza...)" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-brand-500 outline-none mb-4 text-sm font-mono">
            <button onclick="saveApiKey()" class="w-full bg-brand-600 text-white font-bold py-3 rounded-lg hover:bg-brand-700 transition">Simpan & Teruskan</button>
            <p class="text-xs text-center mt-4 text-slate-400">
                <a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline hover:text-brand-500">Dapatkan API Key di sini</a>
            </p>
            <button onclick="closeApiModal()" class="w-full mt-2 text-slate-400 text-xs hover:text-slate-600">Batal (Guna mod manual)</button>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="bg-white/90 backdrop-blur-md fixed w-full z-50 border-b border-slate-200 shadow-sm">
        <div class="container mx-auto px-4 h-16 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="bg-gradient-to-br from-brand-600 to-purple-600 text-white w-9 h-9 rounded-lg flex items-center justify-center shadow-lg shadow-brand-500/30">
                    <i class="fa-solid fa-robot"></i>
                </div>
                <span class="font-bold text-xl tracking-tight text-slate-800">Sir<span class="text-brand-600">SM</span>.AI</span>
            </div>
            <div class="hidden md:flex gap-6 text-sm font-medium text-slate-600">
                <a href="#concept" class="hover:text-brand-600 transition">Konsep S.P.K.A</a>
                <a href="#generator" class="hover:text-brand-600 transition">Mesin AI</a>
                <a href="#examples" class="hover:text-brand-600 transition">Contoh</a>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="openApiModal()" class="text-slate-400 hover:text-brand-600 transition" title="Tetapan API Key">
                    <i class="fa-solid fa-gear"></i>
                </button>
                <a href="#generator" class="inline-flex items-center gap-2 bg-slate-900 text-white px-5 py-2 rounded-full text-sm font-semibold hover:bg-slate-800 transition shadow-lg shadow-slate-900/20 group">
                    Mula <i class="fa-solid fa-arrow-right group-hover:translate-x-1 transition"></i>
                </a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="pt-32 pb-20 px-4 relative overflow-hidden">
        <div class="blob bg-blue-300 w-96 h-96 rounded-full top-0 right-0 mix-blend-multiply"></div>
        <div class="blob bg-purple-300 w-96 h-96 rounded-full bottom-0 left-0 mix-blend-multiply animation-delay-2000"></div>
        
        <div class="container mx-auto text-center max-w-4xl relative z-10">
            <div class="inline-flex items-center gap-2 bg-white border border-slate-200 rounded-full px-4 py-1.5 shadow-sm mb-6 animate-bounce-slow">
                <span class="w-2 h-2 rounded-full bg-green-500"></span>
                <span class="text-xs font-bold uppercase tracking-wide text-slate-500">Dikuasakan oleh Google Gemini</span>
            </div>
            <h1 class="text-4xl md:text-6xl font-bold mb-6 leading-tight tracking-tight">
                Kuasai AI Seperti <br><span class="gradient-text">0.1% Pakar</span>
            </h1>
            <p class="text-lg md:text-xl text-slate-600 mb-8 max-w-2xl mx-auto leading-relaxed">
                Panduan interaktif PPD Alor Gajah. Kini dengan <strong>Integrasi AI Pintar</strong> untuk mengautomasikan kerja anda.
            </p>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="#concept" class="bg-white text-slate-700 border border-slate-200 px-8 py-3.5 rounded-xl font-bold hover:bg-slate-50 transition shadow-sm flex items-center gap-2">
                    <i class="fa-solid fa-book-open"></i> Faham Konsep
                </a>
                <a href="#generator" class="bg-brand-600 text-white px-8 py-3.5 rounded-xl font-bold hover:bg-brand-700 transition shadow-xl shadow-brand-600/30 flex items-center gap-2">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> Cuba Mesin AI
                </a>
            </div>
        </div>
    </header>

    <!-- Konsep S.P.K.A Section -->
    <section id="concept" class="py-20 bg-white border-y border-slate-100">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <span class="text-brand-600 font-bold tracking-wider text-xs uppercase bg-brand-50 px-3 py-1 rounded-full">Teori Asas</span>
                <h2 class="text-3xl font-bold text-slate-900 mt-3">Kenapa Perlu Guna S.P.K.A?</h2>
                <p class="text-slate-500 mt-4 max-w-3xl mx-auto text-lg">
                    AI seperti Gemini umpama <strong>"Anak Genius 5 Tahun"</strong>. Dia sangat pandai, tetapi tiada pengalaman hidup (common sense).
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center max-w-5xl mx-auto">
                <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                    <h3 class="font-bold text-xl mb-4"><i class="fa-solid fa-utensils text-brand-600 mr-2"></i>Analogi Memesan Makanan</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        Bayangkan anda suruh tukang masak: <br>
                        <span class="italic text-red-500">"Masakkan saya nasi."</span> (Arahan Lemah)
                    </p>
                    <p class="text-slate-600 leading-relaxed">
                        Hasilnya mungkin nasi putih kosong atau nasi mentah. <strong>Tukang masak terpaksa meneka.</strong>
                    </p>
                    <div class="my-4 border-t border-slate-200"></div>
                    <p class="font-medium text-green-700 bg-green-50 p-3 rounded-lg border border-green-200">
                        "Saya pelanggan lapar (S). Anda Chef 5 Bintang (P). Saya mahu pedas (K). Masakkan Nasi Goreng Kampung (A)."
                    </p>
                    <p class="text-slate-600 mt-3 text-sm">Hasilnya pasti tepat!</p>
                </div>

                <div class="space-y-4">
                    <div class="flex gap-4 p-4 border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition bg-white">
                        <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center font-bold text-xl flex-shrink-0">S</div>
                        <div>
                            <h4 class="font-bold text-slate-800">Siapa Saya (Identity)</h4>
                            <p class="text-sm text-slate-500 mt-1">Menentukan <strong>laras bahasa</strong>. (Murid vs Pegawai PPD).</p>
                        </div>
                    </div>
                    
                    <div class="flex gap-4 p-4 border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition bg-white">
                        <div class="w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center font-bold text-xl flex-shrink-0">P</div>
                        <div>
                            <h4 class="font-bold text-slate-800">Peranan AI (Persona)</h4>
                            <p class="text-sm text-slate-500 mt-1">Kunci <strong>kualiti</strong>. "Bertindak sebagai 0.1% Pakar".</p>
                        </div>
                    </div>

                    <div class="flex gap-4 p-4 border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition bg-white">
                        <div class="w-12 h-12 bg-amber-100 text-amber-600 rounded-lg flex items-center justify-center font-bold text-xl flex-shrink-0">K</div>
                        <div>
                            <h4 class="font-bold text-slate-800">Konteks (Context)</h4>
                            <p class="text-sm text-slate-500 mt-1">Elak <strong>halusinasi</strong>. Beri latar belakang masalah.</p>
                        </div>
                    </div>

                    <div class="flex gap-4 p-4 border border-slate-100 rounded-xl shadow-sm hover:shadow-md transition bg-white">
                        <div class="w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center font-bold text-xl flex-shrink-0">A</div>
                        <div>
                            <h4 class="font-bold text-slate-800">Arahan (Action)</h4>
                            <p class="text-sm text-slate-500 mt-1">Tentukan <strong>format</strong>. (Jadual, Kod, Surat).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Generator Section (AI INTEGRATED) -->
    <section id="generator" class="py-20 bg-slate-900 text-white relative">
        <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-5"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold mb-3 flex justify-center items-center gap-3">
                    Mesin Prompt S.P.K.A <span class="bg-brand-600 text-xs px-2 py-1 rounded-md animate-pulse">AI-Powered ✨</span>
                </h2>
                <p class="text-slate-400">Isi manual atau minta AI isikan untuk anda.</p>
            </div>

            <div class="max-w-4xl mx-auto bg-white text-slate-800 rounded-2xl p-6 md:p-10 shadow-2xl shadow-black/20 relative overflow-hidden">
                
                <!-- AI Auto-Fill Feature -->
                <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-xl border border-purple-100 mb-8">
                    <label class="block text-sm font-bold text-purple-700 mb-2">✨ Malas menaip? Guna 'Magic Fill' Gemini</label>
                    <div class="flex gap-2">
                        <input type="text" id="magicInput" placeholder="Cth: Saya nak buat kertas kerja sukan sekolah..." class="w-full p-3 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-sm">
                        <button onclick="runMagicFill()" id="magicBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg font-bold transition flex items-center gap-2 whitespace-nowrap">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> <span class="hidden sm:inline">Auto-Isi</span>
                        </button>
                    </div>
                    <p class="text-xs text-purple-400 mt-2 italic">*AI akan berfikir dan mengisi borang S.P.K.A di bawah untuk anda.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-5">
                    <div>
                        <label class="block text-xs font-bold uppercase text-slate-500 mb-2">S - Siapa Anda (Identity)</label>
                        <input type="text" id="inputS" placeholder="Cth: Pegawai Kaunseling" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-600 focus:border-brand-600 outline-none transition font-medium">
                    </div>
                    <div>
                        <label class="block text-xs font-bold uppercase text-slate-500 mb-2">P - Peranan AI (Persona)</label>
                        <input type="text" id="inputP" placeholder="Cth: Pakar Psikologi Remaja" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-600 focus:border-brand-600 outline-none transition font-medium">
                    </div>
                </div>
                <div class="mb-5">
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-2">K - Konteks (Latar Belakang)</label>
                    <textarea id="inputK" rows="3" placeholder="Terangkan masalah..." class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-600 focus:border-brand-600 outline-none transition font-medium"></textarea>
                </div>
                <div class="mb-8">
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-2">A - Arahan Spesifik (Output)</label>
                    <textarea id="inputA" rows="3" placeholder="Apa hasil akhir?..." class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-600 focus:border-brand-600 outline-none transition font-medium"></textarea>
                </div>

                <button onclick="generatePrompt()" class="w-full bg-brand-600 hover:bg-brand-700 text-white font-bold py-4 rounded-xl transition shadow-lg flex items-center justify-center gap-2 text-lg transform hover:-translate-y-1">
                    <i class="fa-solid fa-bolt"></i> Gabung & Jana Prompt
                </button>

                <!-- Result Area -->
                <div id="resultArea" class="hidden mt-8 animate-fade-in pt-8 border-t border-slate-100">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-3 px-1 gap-3">
                        <span class="text-xs font-bold text-green-600 uppercase tracking-wide flex items-center gap-2">
                            <i class="fa-solid fa-check-circle"></i> Prompt Sedia Ada
                        </span>
                        <div class="flex gap-2 w-full md:w-auto">
                             <button onclick="copyToClipboard('finalPrompt')" class="flex-1 md:flex-none text-xs bg-slate-100 hover:bg-slate-200 text-slate-600 px-4 py-2 rounded-lg font-bold transition flex items-center justify-center gap-2">
                                <i class="fa-regular fa-copy"></i> Salin
                            </button>
                            <!-- NEW AI FEATURE: Test Run -->
                            <button onclick="runSimulation()" id="simBtn" class="flex-1 md:flex-none text-xs bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-lg font-bold hover:shadow-lg transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-play"></i> Uji Lari (Live)
                            </button>
                        </div>
                    </div>
                    
                    <textarea id="finalPrompt" readonly class="w-full p-5 bg-brand-50 border border-brand-100 rounded-xl text-slate-700 font-mono text-sm leading-relaxed h-48 focus:outline-none resize-none shadow-inner mb-4"></textarea>

                    <!-- Simulation Result Container -->
                    <div id="simulationArea" class="hidden rounded-xl border border-indigo-100 overflow-hidden shadow-lg">
                        <div class="bg-indigo-50 px-4 py-2 border-b border-indigo-100 flex justify-between items-center">
                            <span class="text-xs font-bold text-indigo-700 flex items-center gap-2">
                                <i class="fa-solid fa-robot"></i> Respons Gemini
                            </span>
                            <span class="text-[10px] text-indigo-400">Model: Gemini 2.5 Flash</span>
                        </div>
                        <div id="simulationOutput" class="p-6 bg-white prose prose-sm max-w-none text-slate-600 h-64 overflow-y-auto">
                            <!-- AI Response will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sector Examples -->
    <section id="examples" class="py-20 bg-slate-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-4 text-slate-900">Bank Prompt Mengikut Sektor</h2>
            <p class="text-center text-slate-500 mb-10">Pilih sektor anda dan salin prompt yang telah dioptimumkan.</p>
            
            <!-- Tabs -->
            <div class="flex flex-wrap justify-center gap-3 mb-10 max-w-4xl mx-auto">
                <button onclick="switchTab('perancangan')" class="tab-btn tab-active px-5 py-2.5 rounded-full border text-sm font-bold transition shadow-sm">Perancangan</button>
                <button onclick="switchTab('pembelajaran')" class="tab-btn tab-inactive px-5 py-2.5 rounded-full border text-sm font-bold transition shadow-sm">Pembelajaran</button>
                <button onclick="switchTab('murid')" class="tab-btn tab-inactive px-5 py-2.5 rounded-full border text-sm font-bold transition shadow-sm">Pembangunan Murid</button>
                <button onclick="switchTab('sekolah')" class="tab-btn tab-inactive px-5 py-2.5 rounded-full border text-sm font-bold transition shadow-sm">Pengurusan Sekolah</button>
                <button onclick="switchTab('akp')" class="tab-btn tab-inactive px-5 py-2.5 rounded-full border text-sm font-bold transition shadow-sm">AKP (Pejabat)</button>
            </div>

            <!-- Content Area -->
            <div class="max-w-4xl mx-auto">
                <!-- Sektor Perancangan -->
                <div id="perancangan" class="sector-content block animate-fade-in">
                    <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-lg relative group">
                        <button onclick="copyContent('promptPlan')" class="absolute top-6 right-6 text-slate-300 hover:text-brand-600 transition"><i class="fa-regular fa-copy fa-xl"></i></button>
                        <h3 class="font-bold text-xl mb-3 text-brand-600"><i class="fa-solid fa-chart-pie mr-2"></i>Analisis Data & OPPM</h3>
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 font-mono text-sm text-slate-600 whitespace-pre-line leading-relaxed" id="promptPlan">
[SIAPA SAYA]
Saya Pegawai Sektor Perancangan PPD.

[PERANAN AI]
Bertindak sebagai 0.1% pakar dalam Perancangan Strategik Pendidikan dan Analisis Data (Data Scientist).

[KONTEKS]
Saya sedang merangka OPPM (One Page Project Manager) untuk meningkatkan pencapaian STEM daerah. Data menunjukkan murid luar bandar kurang berminat.

[ARAHAN]
Sediakan rangka strategi intervensi berdasarkan model PDCA.
1. Cadangkan 3 aktiviti berimpak tinggi kos rendah.
2. Senaraikan KPI yang boleh diukur.
3. Bina jadual teks untuk OPPM (Objektif, Tugas, Tarikh, Kos).

Hasilkan output profesional sedia untuk slaid.
                        </div>
                    </div>
                </div>

                <!-- Sektor Pembelajaran -->
                <div id="pembelajaran" class="sector-content hidden">
                    <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-lg relative">
                        <button onclick="copyContent('promptLearn')" class="absolute top-6 right-6 text-slate-300 hover:text-brand-600 transition"><i class="fa-regular fa-copy fa-xl"></i></button>
                        <h3 class="font-bold text-xl mb-3 text-brand-600"><i class="fa-solid fa-chalkboard-user mr-2"></i>Inovasi RPH & PBL</h3>
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 font-mono text-sm text-slate-600 whitespace-pre-line leading-relaxed" id="promptLearn">
[SIAPA SAYA]
Saya Pegawai SISC+ Sektor Pembelajaran.

[PERANAN AI]
Bertindak sebagai 0.1% Pakar Pedagogi Abad Ke-21.

[KONTEKS]
Murid tahun 4 pasif dalam subjek Sains (Topik: Tenaga). Mereka cepat bosan dengan kaedah 'chalk and talk'.

[ARAHAN]
Berikan 3 idea aktiviti PBL mini (1 jam).
1. Guna bahan kitar semula.
2. Ada pergerakan fizikal.
3. Elemen gamifikasi.
Sediakan rubrik PBD ringkas dalam bentuk jadual.
                        </div>
                    </div>
                </div>

                <!-- Sektor Pembangunan Murid -->
                <div id="murid" class="sector-content hidden">
                    <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-lg relative">
                        <button onclick="copyContent('promptMurid')" class="absolute top-6 right-6 text-slate-300 hover:text-brand-600 transition"><i class="fa-regular fa-copy fa-xl"></i></button>
                        <h3 class="font-bold text-xl mb-3 text-brand-600"><i class="fa-solid fa-user-graduate mr-2"></i>Modul Motivasi & Sahsiah</h3>
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 font-mono text-sm text-slate-600 whitespace-pre-line leading-relaxed" id="promptMurid">
[SIAPA SAYA]
Saya Pegawai Sektor Pembangunan Murid (HEM).

[PERANAN AI]
Bertindak sebagai 0.1% Pakar Psikologi Remaja dan Kaunseling Pendidikan.

[KONTEKS]
Kami menghadapi isu kehadiran merosot pasca-cuti sekolah. Kami ingin anjurkan Program "Jom Sekolah" tapi murid bosan dengan ceramah biasa. Sasaran: Murid Tingkatan 3 (Gen Z).

[ARAHAN]
Rangkakan modul program 2 jam yang berkonsepkan "Gamifikasi & Team Bonding".
1. Berikan tajuk program yang 'Catchy' dan muda.
2. Senaraikan 3 Checkpoint aktiviti yang membina jati diri tanpa rasa seperti kuliah.
3. Sediakan skrip pembukaan yang bertenaga untuk fasilitator.

Hasilkan idea yang segar dan tidak klise.
                        </div>
                    </div>
                </div>
                
                <!-- Sektor Sekolah -->
                <div id="sekolah" class="sector-content hidden">
                     <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-lg relative">
                        <button onclick="copyContent('promptSchool')" class="absolute top-6 right-6 text-slate-300 hover:text-brand-600 transition"><i class="fa-regular fa-copy fa-xl"></i></button>
                        <h3 class="font-bold text-xl mb-3 text-brand-600"><i class="fa-solid fa-school mr-2"></i>Memo Rasmi & Komunikasi</h3>
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 font-mono text-sm text-slate-600 whitespace-pre-line leading-relaxed" id="promptSchool">
[SIAPA SAYA]
Saya Pegawai Sektor Pengurusan Sekolah.

[PERANAN AI]
Bertindak sebagai pakar Komunikasi Korporat Sektor Awam.

[KONTEKS]
Memo peringatan waktu pulang guru bulan Ramadhan. Nada tegas tapi berhemah.

[ARAHAN]
Drafkan memo rasmi kerajaan.
1. Guna bahasa istana/rasmi standard.
2. Tekankan integriti dan keberkatan.
3. Hasilkan teks penuh siap tampal.
                        </div>
                    </div>
                </div>

                <!-- Sektor AKP -->
                <div id="akp" class="sector-content hidden">
                     <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-lg relative">
                        <button onclick="copyContent('promptAKP')" class="absolute top-6 right-6 text-slate-300 hover:text-brand-600 transition"><i class="fa-regular fa-copy fa-xl"></i></button>
                        <h3 class="font-bold text-xl mb-3 text-brand-600"><i class="fa-solid fa-file-contract mr-2"></i>Minit Mesyuarat & Surat</h3>
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200 font-mono text-sm text-slate-600 whitespace-pre-line leading-relaxed" id="promptAKP">
[SIAPA SAYA]
Saya AKP PPD.

[PERANAN AI]
Bertindak sebagai Setiausaha Eksekutif Profesional.

[KONTEKS]
Nota ringkas mesyuarat aset: Pengerusi marah aset tak daftar, laporan perlu hantar 15hb.

[ARAHAN]
Tukar nota kepada Minit Mesyuarat rasmi.
1. Format minit kerajaan.
2. Ayat pasif gramatis (Mesyuarat mengambil maklum...).
3. Hasilkan draf penuh.
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- Interactive Quiz Section -->
    <section id="quiz-section" class="py-20 bg-white border-t border-slate-100">
        <div class="container mx-auto px-4 max-w-3xl">
            <div class="text-center mb-10">
                <span class="text-brand-600 font-bold tracking-wider text-xs uppercase bg-brand-50 px-3 py-1 rounded-full">Cabaran Minda</span>
                <h2 class="text-3xl font-bold text-slate-900 mt-3">Ujian Kefahaman AI SirSM</h2>
                <p class="text-slate-500 mt-2">Buktikan anda bukan sekadar pengguna biasa. Sasarkan 10/10!</p>
            </div>

            <!-- Quiz Card -->
            <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden relative min-h-[400px]">
                <div class="w-full bg-slate-100 h-2">
                    <div id="progressBar" class="bg-brand-500 h-2 transition-all duration-500" style="width: 0%"></div>
                </div>
                <div id="quizContent" class="p-8 md:p-10">
                    <div class="flex justify-between items-center mb-6">
                        <span id="questionCounter" class="text-sm font-bold text-slate-400">Soalan 1/10</span>
                        <span id="scoreDisplay" class="text-sm font-bold text-brand-600 bg-brand-50 px-3 py-1 rounded-full">Markah: 0</span>
                    </div>
                    <h3 id="questionText" class="text-xl md:text-2xl font-bold text-slate-800 mb-8 leading-snug">Soalan...</h3>
                    <div id="optionsContainer" class="space-y-3"></div>
                    <div id="feedbackArea" class="hidden mt-6 p-4 rounded-xl text-sm font-medium animate-pulse"></div>
                    <div class="mt-8 flex justify-end">
                        <button id="nextBtn" onclick="nextQuestion()" class="hidden bg-slate-900 text-white px-6 py-2 rounded-lg font-bold hover:bg-slate-800 transition">Seterusnya <i class="fa-solid fa-arrow-right ml-2"></i></button>
                    </div>
                </div>
                <div id="resultScreen" class="hidden absolute inset-0 bg-white flex flex-col items-center justify-center p-8 text-center z-10">
                    <div class="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-4xl mb-4 shadow-lg"><i class="fa-solid fa-trophy"></i></div>
                    <h3 class="text-2xl font-bold text-slate-900 mb-2">Kuiz Tamat!</h3>
                    <div class="text-5xl font-black text-brand-600 mb-2" id="finalScore">0/10</div>
                    <p id="finalMessage" class="text-lg font-medium text-slate-700 mb-8">Hebat!</p>
                    <button onclick="restartQuiz()" class="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-800 transition shadow-lg"><i class="fa-solid fa-rotate-right mr-2"></i> Cuba Lagi</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Keywords Section -->
    <section class="py-20 bg-slate-50 border-t border-slate-200">
         <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-10 text-slate-900">Kata Kunci <span class="text-brand-600">"Power"</span> (Dwibahasa)</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div onclick="copyText('Jelaskan langkah demi langkah (Think step-by-step)')" class="p-5 border border-slate-200 rounded-xl hover:border-brand-500 hover:shadow-lg transition cursor-pointer group bg-white">
                    <div class="font-bold text-brand-600 mb-1">Step-by-step</div>
                    <div class="text-xs text-slate-400 italic mb-2">"Langkah demi langkah"</div>
                    <p class="text-xs text-slate-600">Untuk matematik & logik.</p>
                </div>
                <div onclick="copyText('Jelaskan seperti saya berumur 5 tahun (Explain Like I\'m 5)')" class="p-5 border border-slate-200 rounded-xl hover:border-brand-500 hover:shadow-lg transition cursor-pointer group bg-white">
                    <div class="font-bold text-brand-600 mb-1">ELI5</div>
                    <div class="text-xs text-slate-400 italic mb-2">"Macam budak 5 tahun"</div>
                    <p class="text-xs text-slate-600">Permudahkan topik susah.</p>
                </div>
                <div onclick="copyText('Sediakan dalam format Jadual (Table format)')" class="p-5 border border-slate-200 rounded-xl hover:border-brand-500 hover:shadow-lg transition cursor-pointer group bg-white">
                    <div class="font-bold text-brand-600 mb-1">Format Jadual</div>
                    <div class="text-xs text-slate-400 italic mb-2">"Table format"</div>
                    <p class="text-xs text-slate-600">Banding data dengan kemas.</p>
                </div>
                <div onclick="copyText('Hasilkan kod penuh siap tampal (Full runnable code)')" class="p-5 border border-slate-200 rounded-xl hover:border-brand-500 hover:shadow-lg transition cursor-pointer group bg-white">
                    <div class="font-bold text-brand-600 mb-1">Kod Siap Tampal</div>
                    <div class="text-xs text-slate-400 italic mb-2">"Full runnable code"</div>
                    <p class="text-xs text-slate-600">Untuk HTML/Excel/Python.</p>
                </div>
            </div>
         </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-400 py-10 text-center border-t border-slate-800">
        <div class="container mx-auto px-4">
            <div class="mb-4 text-2xl text-slate-600"><i class="fa-solid fa-robot"></i></div>
            <p class="mb-2 font-medium">Dibangunkan khas oleh <strong>SirSM</strong></p>
            <p class="text-sm">Unit Sumber Teknologi Pendidikan (USTP) PPD Alor Gajah</p>
            <p class="mt-6 text-xs text-slate-600">&copy; <span id="currentYear"></span>. Hak Cipta Terpelihara.</p>
            <p class="mt-2 text-xs text-slate-700 cursor-pointer hover:text-slate-500" onclick="openApiModal()">Tetapan API</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- API & AI LOGIC ---
        // In the preview environment, this is empty.
        // But if user exports file, they need to supply key.
        let apiKey = ""; 

        function openApiModal() {
            document.getElementById('apiKeyModal').classList.remove('hidden');
            const savedKey = localStorage.getItem('gemini_api_key');
            if(savedKey) document.getElementById('userApiKey').value = savedKey;
        }

        function closeApiModal() {
            document.getElementById('apiKeyModal').classList.add('hidden');
        }

        function saveApiKey() {
            const input = document.getElementById('userApiKey').value.trim();
            if(input) {
                apiKey = input;
                localStorage.setItem('gemini_api_key', input);
                alert("API Key berjaya disimpan!");
                closeApiModal();
            } else {
                alert("Sila masukkan API Key yang sah.");
            }
        }

        // Check for saved key on load
        window.onload = function() {
             const savedKey = localStorage.getItem('gemini_api_key');
             if(savedKey) apiKey = savedKey;
             loadQuiz();
        };

        async function callGemini(promptText, systemInstruction = "") {
            // Check if we have a key (either from env or user input)
            // Note: In some environments, __env_api_key might be injected, handled below securely if existing
            let currentKey = apiKey; 
            
            // Fallback for demo environment if const is empty string (will be filled by runtime if applicable)
            // If completely empty, prompt user
            if (!currentKey) {
                openApiModal();
                throw new Error("API Key Missing");
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${currentKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: promptText }] }],
                // Add system instruction if provided (model dependent support)
                // For simplicity in flash-preview, we prepend to prompt if system instruction structure fails, 
                // but let's try standard structure first.
            };

            if (systemInstruction) {
                payload.systemInstruction = { parts: [{ text: systemInstruction }] };
            }

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error("Gagal menghubungi Gemini: " + response.statusText);
                
                const data = await response.json();
                return data.candidates[0].content.parts[0].text;

            } catch (error) {
                console.error(error);
                alert("Ralat AI: " + error.message + ". Pastikan API Key anda sah.");
                return null;
            }
        }

        // 1. Magic Fill Logic
        async function runMagicFill() {
            const topic = document.getElementById('magicInput').value.trim();
            if(!topic) { alert("Sila masukkan topik dahulu!"); return; }

            const btn = document.getElementById('magicBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Berfikir...`;
            btn.disabled = true;

            const systemPrompt = "Anda adalah Pakar Prompt Engineering. Tugas anda adalah menukar permintaan ringkas pengguna menjadi 4 elemen S.P.K.A (Siapa, Peranan, Konteks, Arahan). Berikan output dalam format JSON sahaja: { \"s\": \"...\", \"p\": \"...\", \"k\": \"...\", \"a\": \"...\" } dalam Bahasa Melayu.";
            
            const aiResponse = await callGemini(`Tukarkan topik ini kepada S.P.K.A: "${topic}"`, systemPrompt);

            if(aiResponse) {
                try {
                    // Clean code fences if AI adds them
                    const jsonStr = aiResponse.replace(/```json/g, '').replace(/```/g, '').trim();
                    const data = JSON.parse(jsonStr);
                    
                    document.getElementById('inputS').value = data.s || "";
                    document.getElementById('inputP').value = data.p || "";
                    document.getElementById('inputK').value = data.k || "";
                    document.getElementById('inputA').value = data.a || "";
                    
                    // Smooth scroll to form
                    document.getElementById('inputS').scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                } catch (e) {
                    alert("Gagal memproses respons AI. Sila cuba lagi.");
                }
            }

            btn.innerHTML = originalText;
            btn.disabled = false;
        }

        // 2. Simulation Logic
        async function runSimulation() {
            const prompt = document.getElementById('finalPrompt').value;
            if(!prompt) { alert("Sila jana prompt dahulu!"); return; }

            const area = document.getElementById('simulationArea');
            const output = document.getElementById('simulationOutput');
            const btn = document.getElementById('simBtn');
            
            area.classList.remove('hidden');
            output.innerHTML = `<div class="flex items-center gap-2 text-slate-400"><i class="fa-solid fa-circle-notch fa-spin"></i> Gemini sedang menulis jawapan...</div>`;
            btn.disabled = true;

            const aiResponse = await callGemini(prompt);

            if(aiResponse) {
                // Parse Markdown using marked.js
                output.innerHTML = marked.parse(aiResponse);
            } else {
                output.innerHTML = `<span class="text-red-500">Ralat simulasi.</span>`;
            }

            btn.disabled = false;
        }


        // --- QUIZ DATA ---
        const questions = [
            { q: "Apakah maksud huruf 'S' dalam formula S.P.K.A?", options: ["Situasi", "Siapa Saya", "Subjek", "Solusi"], correct: 1, explanation: "S = Siapa Saya. Anda perlu kenalkan diri supaya AI tahu laras bahasa yang sesuai." },
            { q: "Untuk mendapatkan jawapan paling berkualiti, peranan (P) apakah yang paling sesuai?", options: ["Kawan baik", "Pakar biasa", "0.1% Pakar dalam bidang", "Penolong Kanan"], correct: 2, explanation: "'0.1% Pakar' memaksa AI mengakses pangkalan data pengetahuan yang paling mendalam." },
            { q: "Mengapakah kita perlu memberi Konteks (K) kepada AI?", options: ["Supaya AI tidak bosan", "AI boleh baca hati kita", "AI tiada pengalaman hidup", "Syarat wajib Google"], correct: 2, explanation: "AI umpama anak genius tanpa pengalaman. Tanpa konteks, ia akan 'meneka' dan mungkin salah." },
            { q: "Jika anda membuka 'New Chat', adakah Gemini ingat perbualan semalam?", options: ["Ya, ingat sepenuhnya", "Tidak, ia bermula kosong (Amnesia)", "Ingat sikit-sikit", "Hanya jika bayar"], correct: 1, explanation: "Setiap 'New Chat' adalah sesi baru. AI tiada memori jangka panjang antara sesi." },
            { q: "Apakah analogi terbaik untuk menggambarkan AI seperti Gemini?", options: ["Robot pemusnah", "Kamus bergerak", "Anak genius 5 tahun", "Mesin taip"], correct: 2, explanation: "Ia sangat pandai (genius) tapi perlukan arahan spesifik macam budak 5 tahun." },
            { q: "Maklumat apakah yang DILARANG sama sekali dimasukkan ke dalam prompt AI awam?", options: ["Nama sekolah", "Tarikh program", "Maklumat sulit (No.KP / Nama Murid)", "Subjek diajar"], correct: 2, explanation: "Demi keselamatan data, jangan sesekali masukkan data peribadi atau sulit kerajaan." },
            { q: "Kata kunci 'ELI5' bermaksud?", options: ["Explain Like I'm 5", "English Lesson Is 5", "Extra Large Input 5", "Error Level 5"], correct: 0, explanation: "Ia meminta AI menerangkan topik susah dengan bahasa yang sangat mudah." },
            { q: "Jika jawapan AI terlalu panjang, apa perlu buat?", options: ["Buat lagi", "Ringkaskan / Point form", "Tukar topik", "Diam"], correct: 1, explanation: "Arahkan spesifik format output seperti 'Ringkaskan dalam 3 poin'." },
            { q: "Untuk Matematik, kata kunci apa terbaik?", options: ["Kira cepat", "Fikir langkah demi langkah", "Teka jawapan", "Guna kalkulator"], correct: 1, explanation: "Teknik 'Chain of Thought' ini mengurangkan kesilapan pengiraan AI." },
            { q: "Apakah maksud 'Hasilkan kod penuh siap tampal'?", options: ["AI buat separuh jalan", "AI bagi link website", "AI beri kod lengkap tanpa perlu edit", "AI suruh kita buat sendiri"], correct: 2, explanation: "Ini menjimatkan masa supaya anda boleh terus guna hasil kerja." }
        ];

        let currentQuestion = 0, score = 0, answered = false;

        function loadQuiz() {
            if(currentQuestion >= questions.length) { showResults(); return; }
            const q = questions[currentQuestion];
            document.getElementById('questionText').innerText = q.q;
            document.getElementById('questionCounter').innerText = `Soalan ${currentQuestion + 1}/${questions.length}`;
            document.getElementById('progressBar').style.width = `${((currentQuestion) / questions.length) * 100}%`;
            const optsDiv = document.getElementById('optionsContainer');
            optsDiv.innerHTML = '';
            q.options.forEach((opt, index) => {
                const btn = document.createElement('div');
                btn.className = 'quiz-option p-4 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50 flex items-center gap-3 bg-white';
                btn.innerHTML = `<div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-500 text-sm">${String.fromCharCode(65+index)}</div><span class="font-medium">${opt}</span>`;
                btn.onclick = () => checkAnswer(index, btn);
                optsDiv.appendChild(btn);
            });
            document.getElementById('feedbackArea').className = 'hidden mt-6 p-4 rounded-xl text-sm font-medium';
            document.getElementById('nextBtn').classList.add('hidden');
            answered = false;
        }

        function checkAnswer(idx, btn) {
            if(answered) return; answered = true;
            const q = questions[currentQuestion];
            const feedback = document.getElementById('feedbackArea');
            if(idx === q.correct) {
                score++; document.getElementById('scoreDisplay').innerText = `Markah: ${score}`;
                btn.classList.add('quiz-correct');
                feedback.innerHTML = `<i class="fa-solid fa-check-circle mr-2"></i><strong>Tepat!</strong> ${q.explanation}`;
                feedback.classList.remove('hidden', 'bg-red-50', 'text-red-700'); feedback.classList.add('bg-green-50', 'text-green-700');
            } else {
                btn.classList.add('quiz-wrong');
                document.querySelectorAll('.quiz-option')[q.correct].classList.add('quiz-correct');
                feedback.innerHTML = `<i class="fa-solid fa-circle-xmark mr-2"></i><strong>Kurang Tepat.</strong> ${q.explanation}`;
                feedback.classList.remove('hidden', 'bg-green-50', 'text-green-700'); feedback.classList.add('bg-red-50', 'text-red-700');
            }
            document.getElementById('nextBtn').classList.remove('hidden');
        }

        function nextQuestion() { currentQuestion++; loadQuiz(); }
        function showResults() {
            document.getElementById('progressBar').style.width = '100%';
            document.getElementById('quizContent').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            document.getElementById('finalScore').innerText = `${score}/10`;
            document.getElementById('finalMessage').innerText = score===10?"Sempurna! Anda 0.1% Pakar!":score>=8?"Tahniah! Sangat baik.":"Cuba lagi ya!";
        }
        function restartQuiz() {
            currentQuestion=0; score=0; document.getElementById('scoreDisplay').innerText=`Markah: 0`;
            document.getElementById('quizContent').classList.remove('hidden');
            document.getElementById('resultScreen').classList.add('hidden');
            loadQuiz();
        }

        // --- GENERATOR LOGIC ---
        document.getElementById('currentYear').innerText = new Date().getFullYear();

        function generatePrompt() {
            const s = document.getElementById('inputS').value.trim();
            const p = document.getElementById('inputP').value.trim();
            const k = document.getElementById('inputK').value.trim();
            const a = document.getElementById('inputA').value.trim();
            if (!s || !p || !k || !a) { alert("Sila isi kesemua ruangan S.P.K.A!"); return; }
            const prompt = `[SIAPA SAYA]\nSaya adalah ${s}.\n\n[PERANAN AI]\nBertindak sebagai 0.1% pakar dalam bidang ${p} yang mempunyai pengalaman luas dan pemikiran kritikal.\n\n[KONTEKS]\n${k}\n\n[ARAHAN]\n${a}\n\nSila pastikan jawapan anda terperinci, tepat, profesional, dan jika melibatkan kod/format, hasilkan output penuh yang siap untuk disalin dan digunakan (ready-to-use).`;
            const finalArea = document.getElementById('finalPrompt');
            finalArea.value = prompt;
            document.getElementById('resultArea').classList.remove('hidden');
            finalArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function copyToClipboard(id) {
            const el = document.getElementById(id); el.select(); el.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(el.value).then(() => alert("Teks berjaya disalin!"));
        }

        function switchTab(id) {
            document.querySelectorAll('.sector-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(btn => { btn.classList.remove('tab-active'); btn.classList.add('tab-inactive'); });
            event.target.classList.remove('tab-inactive'); event.target.classList.add('tab-active');
        }

        function copyContent(id) { navigator.clipboard.writeText(document.getElementById(id).innerText).then(() => alert("Prompt contoh disalin!")); }
        function copyText(text) { navigator.clipboard.writeText(text).then(() => alert("Kata kunci disalin!")); }

    </script>
</body>
</html>